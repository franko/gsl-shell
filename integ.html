
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Numerical Integration &#8212; GSL Shell 2.3.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Special functions" href="sf.html" />
    <link rel="prev" title="Ordinary Differential Equations" href="ode.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sf.html" title="Special functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ode.html" title="Ordinary Differential Equations"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">GSL Shell 2.3.5 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Numerical Integration</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="numerical-integration">
<h1>Numerical Integration<a class="headerlink" href="#numerical-integration" title="Permalink to this heading">¶</a></h1>
<p>This chapter describes routines for performing numerical integration
(quadrature) of a function in one dimension.
GSL Shell re-implements the the algorithms used in QUADPACK, a numerical integration package written by Piessens, Doncker-Kapenga, Uberhuber and Kahaner.
FORTRAN code for QUADPACK is available on Netlib.</p>
<p>Currently only two integration methods are available in GSL Shell.
Both of them are based on Gauss-Kronrod integration rules.
The first method is non-adaptive and is called QNG while the seconde one, QAG, is adaptive.
The adaptive method QAG is suitable as a general-purpose integrator, whereas the QNG method should be used only in particular cases where the function has a simple known smooth behavior.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>Each algorithm computes an approximation to a definite integral of the form,</p>
<div class="math">
<p><img src="_images/math/2f140f172a0593b3001b24dbbb5ee32504c48103.png" alt="I = \int_a^b f(x) \textrm{d}x"/></p>
</div><p>The user provides absolute and relative error bounds (epsabs, epsrel)
which specify the following accuracy requirement,</p>
<div class="math">
<p><img src="_images/math/de5595e64d654abdd35ded2e6837beeb9f3ee79e.png" alt="| \textrm{Result} - I |  \le \max(\epsilon_{\textrm{abs}}, \epsilon_{\textrm{abs}} |I|)"/></p>
</div><p>where Result is the numerical approximation obtained by the
algorithm. The algorithm attempts to estimate the absolute error
AbsErr = | Result - I | in such a way that the following inequality
holds,</p>
<div class="math">
<p><img src="_images/math/76b6ce33cc3dd785415492221834950ea8cdeb51.png" alt="| \textrm{Result} - I | \le \textrm{AbsErr} \le \max(\epsilon_{\textrm{abs}}, \epsilon_{\textrm{rel}} |I|)"/></p>
</div><p>In short, the routines return the first approximation which has an
absolute error smaller than epsabs or a relative error smaller than
epsrel.</p>
<p>Note that this is an either-or constraint, not simultaneous. To
compute to a specified absolute error, set epsrel to zero. To compute
to a specified relative error, set epsabs to zero. The routines will
fail to converge if the error bounds are too stringent, but always
return the best approximation obtained up to that stage.</p>
</section>
<section id="module-num">
<span id="functions"></span><h2>Functions<a class="headerlink" href="#module-num" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="num.integ">
<span class="sig-prename descclassname"><span class="pre">num.</span></span><span class="sig-name descname"><span class="pre">integ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsabs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsrel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#num.integ" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the definite integral of the function <code class="docutils literal notranslate"><span class="pre">f</span></code> in the interval specified by <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> within the requested precision given by <code class="docutils literal notranslate"><span class="pre">epsabs</span></code> and <code class="docutils literal notranslate"><span class="pre">epsrel</span></code>.
This function always use the adaptive QAG algorithm internally.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="num.quad_prepare">
<span class="sig-prename descclassname"><span class="pre">num.</span></span><span class="sig-name descname"><span class="pre">quad_prepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#num.quad_prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a function that can perform a numeric integration based on the options <code class="docutils literal notranslate"><span class="pre">spec</span></code>.
The argument <code class="docutils literal notranslate"><span class="pre">spec</span></code> is used to choose the quadrature algorithm, the order and the limits for the adaptive search if applicable.
The fields of <code class="docutils literal notranslate"><span class="pre">spec</span></code> that you should give are:</p>
<dl class="simple">
<dt><em>method</em></dt><dd><p>The quadrature algorithm. Available algorithms are <code class="docutils literal notranslate"><span class="pre">qng</span></code> and <code class="docutils literal notranslate"><span class="pre">qag</span></code>, the default is <code class="docutils literal notranslate"><span class="pre">qag</span></code>.</p>
</dd>
<dt><em>order</em></dt><dd><p>The order of the integration rule.
The default value is 21.</p>
</dd>
<dt><em>limits</em></dt><dd><p>The maximum number of subdivisions for adaptive algorithms.
The default value is 64.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="usage-example">
<h2>Usage Example<a class="headerlink" href="#usage-example" title="Permalink to this heading">¶</a></h2>
<p>Here a simple example that shows how to plot the Bessel function using its integral definition:</p>
<div class="math">
<p><img src="_images/math/0374ff1d9f5d2e8b17e6204f0fcd776c524ed058.png" alt="J_n(x) = {1 \over \pi} \int_0^\pi \cos(n \tau - x \sin \tau) \textrm{d}\tau"/></p>
</div><p>The function <a class="reference internal" href="#num.quad_prepare" title="num.quad_prepare"><code class="xref py py-func docutils literal notranslate"><span class="pre">num.quad_prepare()</span></code></a> is used to prepare the quadrature function.
The function returned is then called many times to obtain <img class="math" src="_images/math/d0c559534541c6100039c20c12fb920ca84f5dd0.png" alt="J_n(x)"/>:</p>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="s1">&#39;math&#39;</span>

<span class="n">epsabs</span><span class="p">,</span> <span class="n">epsrel</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mf">0.01</span>

<span class="kr">function</span> <span class="nf">bessel_gen</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
   <span class="kd">local</span> <span class="n">xs</span>
   <span class="kd">local</span> <span class="n">fint</span> <span class="o">=</span> <span class="kr">function</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="kr">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">xs</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="kr">end</span>
   <span class="kr">return</span> <span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
             <span class="n">xs</span> <span class="o">=</span> <span class="n">x</span>
             <span class="kr">return</span> <span class="n">q</span><span class="p">(</span><span class="n">fint</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">epsabs</span><span class="p">,</span> <span class="n">epsrel</span><span class="p">)</span> <span class="o">/</span> <span class="n">pi</span>
          <span class="kr">end</span>
<span class="kr">end</span>

<span class="c1">-- we get the &#39;qag&#39; integration rule with default options</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">num</span><span class="p">.</span><span class="n">quad_prepare</span> <span class="p">{</span><span class="n">method</span><span class="o">=</span> <span class="s1">&#39;qag&#39;</span><span class="p">}</span>

<span class="n">J7</span> <span class="o">=</span> <span class="n">bessel_gen</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

<span class="n">graph</span><span class="p">.</span><span class="n">fxplot</span><span class="p">(</span><span class="n">J7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Numerical Integration</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#module-num">Functions</a><ul>
<li><a class="reference internal" href="#num.integ"><code class="docutils literal notranslate"><span class="pre">integ()</span></code></a></li>
<li><a class="reference internal" href="#num.quad_prepare"><code class="docutils literal notranslate"><span class="pre">quad_prepare()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage-example">Usage Example</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="ode.html"
                          title="previous chapter">Ordinary Differential Equations</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="sf.html"
                          title="next chapter">Special functions</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/integ.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sf.html" title="Special functions"
             >next</a> |</li>
        <li class="right" >
          <a href="ode.html" title="Ordinary Differential Equations"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">GSL Shell 2.3.5 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Numerical Integration</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2013, Francesco Abbate.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3.
    </div>
  </body>
</html>
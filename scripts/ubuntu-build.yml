image: ubuntu/18.04
packages:
  # xorg-dev can be used instead of the detailed list of x11 libraries
  [python3-pip, make, ninja-build, pkg-config, libx11-dev, libxext-dev, libxrandr-dev, libxrender-dev, libxcursor-dev, libxfixes-dev, libxi-dev, libxft-dev, gcc, g++, gfortran]
sources:
  - https://github.com/franko/gsl-shell
  - https://github.com/franko/lhelper
shell: true
tasks:
  - enable-local: |
      echo 'export PATH="$HOME/.local/bin:$PATH"' >> "$HOME/.buildenv"
  - prepare-setup: |
      pip3 install --user meson
  - lhelper-install: |
      cd lhelper
      bash install "$HOME/.local"
  - lhelper-create-env: |
      lhelper create gsl-shell -n
      source "$(lhelper env-source gsl-shell)"
      lhelper install fox -xft
      lhelper install openblas
  - build: |
      cd gsl-shell
      source "$(lhelper env-source gsl-shell)"
      bash scripts/build-package.sh -openblas
      cd packages
      tar czvf gsl-shell.tar.gz gsl-shell
artifacts:
  - gsl-shell/packages/gsl-shell.tar.gz

